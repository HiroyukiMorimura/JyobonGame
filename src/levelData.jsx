/* eslint-disable react-refresh/only-export-components */
// src/levelData.js

// ã‚¿ã‚¤ãƒ«ID
export const TILE_ID = { Empty: 0, Ground: 1, Spike: 2, Flag: 3, Platform: 4 };

// ãƒ¬ã‚¸ã‚§ãƒ³ãƒ‰: . ç©ºç™½ / # åœ°é¢ / ^ ãƒˆã‚² / F ã‚´ãƒ¼ãƒ«æ——
export const LEGEND = {
  ".": TILE_ID.Empty,
  "#": TILE_ID.Ground,
  "^": TILE_ID.Spike,
  F: TILE_ID.Flag,
};

/**
 * ã‚¿ã‚¤ãƒ«ã‚µã‚¤ã‚º (SideScrollerGame.jsxã®TILEã¨åŒã˜å€¤)
 */
export const TILE = 48;

/**
 * ãƒ”ã‚¯ã‚»ãƒ«åº§æ¨™ã¸ã®å¤‰æ›ãƒ˜ãƒ«ãƒ‘ãƒ¼é–¢æ•°
 * @param {number} n ã‚¿ã‚¤ãƒ«æ•°
 * @returns {number} ãƒ”ã‚¯ã‚»ãƒ«åº§æ¨™
 */
export const T = (n) => n * TILE;

// =================================================================
// ðŸŒŸ æ„åœ°æ‚ªãªã‚¹ãƒ†ãƒ¼ã‚¸å®šç¾© (ç´„300ã‚¿ã‚¤ãƒ«å¹…) ðŸŒŸ
// ã‚¹ã‚¿ãƒ¼ãƒˆç›´å¾Œã«ãƒˆã‚²ã€é«˜é€Ÿç§»å‹•åºŠã€ç²¾å¯†ã‚¸ãƒ£ãƒ³ãƒ—ã‚¨ãƒªã‚¢ã‚’é…ç½®
// =================================================================
export const LEVEL = String.raw`
...........................................................................................................................................................................................................................................................................................................
...........................................................................................................................................................................................................................................................................................................
...........................................................................................................................................................................................................................................................................................................
...........................................................................................................................................................................................................................................................................................................
..................................................................................................................................................................................................................................................................................F
..................^^..^^..^^^^^^^^^.^.^#...................#.......................#...................................#....................................#...................#..................................#...............................................................
...............##........................#.........^.......#.........^.......#......^.....^.....^.....^...^..^...^....#......................^.............#.........^.........#.....................^............#.....^....^....^......^...........#.^...^...^...^................
############..###......................#..######.###.######..######.###.######..######################################.###.####################################.###.###########################.###.####################################.###.####################################
############..###.#####################...............................................................................................................................................................................................................................................
############..###.#####################...............................................................................................................................................................................................................................................
############..###.#####################...............................................................................................................................................................................................................................................
############..###.#####################...............................................................................................................................................................................................................................................
############..###.#####################...............................................................................................................................................................................................................................................
###################################################################################################################################################################################################################################################################################
###################################################################################################################################################################################################################################################################################
`;

// =================================================================
// ðŸŒŸ å¯å‹•ã‚®ãƒŸãƒƒã‚¯ï¼ˆé«˜é€ŸåŒ–ãƒ»è¤‡é›‘åŒ–ï¼‰ðŸŒŸ
// =================================================================

// ç§»å‹•åºŠ (x, y ã¯ãƒ”ã‚¯ã‚»ãƒ«åº§æ¨™, w ã¯ãƒ”ã‚¯ã‚»ãƒ«å¹…)
export const initialMovers = [
  // æ„åœ°æ‚ª1: ã‚¹ã‚¿ãƒ¼ãƒˆç›´å¾Œã®è¶…é«˜é€Ÿãƒ”ã‚¹ãƒˆãƒ³åºŠï¼ˆçŒ¶äºˆãªã—ï¼‰
  { x: T(15), y: T(6), w: T(2), left: T(3), right: T(19), vx: 3.5 },
  // æ„åœ°æ‚ª2: ãƒˆã‚²ã®æµ·ã®ä¸Šã®é«˜é€Ÿãƒ»é•·è·é›¢ã‚¹ãƒ©ã‚¤ãƒ‰åºŠ
  { x: T(35), y: T(7), w: T(3), left: T(30), right: T(50), vx: -2.0 },
  // æ„åœ°æ‚ª3: 2ã¤ã®åºŠãŒä¸Šä¸‹é€†ã®å‹•ãã‚’ã™ã‚‹ï¼ˆã™ã‚Œé•ã„ã‚’é¿ã‘ã•ã›ã‚‹ï¼‰
  { x: T(80), y: T(6), w: T(2), left: T(78), right: T(85), vx: 1.5 },
  { x: T(90), y: T(7), w: T(2), left: T(88), right: T(95), vx: -1.5 },
  // æ„åœ°æ‚ª4: é•·è·é›¢ã‚’é«˜é€Ÿã§å¾€å¾©ã™ã‚‹ç´°ã„è¶³å ´
  { x: T(150), y: T(5), w: T(1), left: T(140), right: T(160), vx: 2.2 },
];

// æ•µï¼ˆé«˜é€ŸåŒ–ãƒ»ç‹­ã„ç¯„å›²ã‚’å·¡å›žï¼‰
export const initialEnemies = [
  // æ„åœ°æ‚ª1: æœ€åˆã®åºŠã‚’é™ã‚ŠãŸå¾Œã®ä½Žç©ºé«˜é€Ÿæ•µ
  {
    x: T(25),
    y: T(7) - 24,
    w: 36,
    h: 36,
    left: T(15),
    right: T(30),
    vx: 3.0,
  },
  // æ„åœ°æ‚ª2: ç‹­ã„ç©ºé–“ã‚’é«˜é€Ÿå·¡å›ž
  {
    x: T(65),
    y: T(8) - 24,
    w: 36,
    h: 36,
    left: T(63),
    right: T(70),
    vx: -3.0,
  },
  // æ„åœ°æ‚ª3: ãƒˆã‚²ã®ä¸Šã®å¾€å¾©ã€‚è¸ã¿ã¤ã‘ä¸èƒ½ã€‚
  {
    x: T(120),
    y: T(7) - 24,
    w: 36,
    h: 36,
    left: T(115),
    right: T(130),
    vx: 1.8,
  },
  // æ„åœ°æ‚ª4: ã‚´ãƒ¼ãƒ«ç›´å‰ã®é«˜é€Ÿç•ªäºº
  {
    x: T(285),
    y: T(10) - 24,
    w: 36,
    h: 36,
    left: T(280),
    right: T(290),
    vx: -2.0,
  },
];

// =================================================================
// ãƒ¦ãƒ¼ãƒ†ã‚£ãƒªãƒ†ã‚£é–¢æ•°
// =================================================================

/**
 * ASCIIãƒžãƒƒãƒ—æ–‡å­—åˆ—ã‚’ã‚¿ã‚¤ãƒ«IDã®äºŒæ¬¡å…ƒé…åˆ—ã«å¤‰æ›ã™ã‚‹
 * @param {string} str ASCIIæ–‡å­—åˆ—ã®ãƒžãƒƒãƒ—
 * @returns {number[][]} ã‚¿ã‚¤ãƒ«ãƒžãƒƒãƒ—
 */
export function parseLevel(str) {
  const rows = str.trim().split("\n");
  const h = rows.length;
  const w = Math.max(...rows.map((r) => r.length));
  return Array.from({ length: h }, (_, y) => {
    const row = rows[y].padEnd(w, ".");
    return Array.from({ length: w }, (_, x) => LEGEND[row[x]] ?? TILE_ID.Empty);
  });
}
